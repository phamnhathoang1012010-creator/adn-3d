<!DOCTYPE html>
<html>
<head>
    <title>3D DNA Model for Teaching</title>
    <style>
        body { margin: 0; background-color: #050505; overflow: hidden; }
        canvas { display: block; }
    </style>
</head>
<body>
    <!-- Nhúng thư viện Three.js từ CDN chính thức -->
    <script type="module">
        import * as THREE from 'https://cdn.skypack.dev';
        import { OrbitControls } from 'https://cdn.skypack.dev/examples/jsm/controls/OrbitControls.js';

        // 1. Khởi tạo môi trường
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // 2. Điều khiển xoay chuột
        const controls = new OrbitControls(camera, renderer.domElement);
        camera.position.z = 20;

        // 3. Ánh sáng cho thẩm mỹ
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        const pointLight = new THREE.PointLight(0xffffff, 1);
        pointLight.position.set(10, 10, 10);
        scene.add(pointLight);

        // 4. Tạo mô hình ADN
        const dnaGroup = new THREE.Group();
        const numPoints = 40; // Số lượng cặp bazơ
        const curveRadius = 4; // Độ rộng vòng xoắn
        const heightStep = 0.5; // Khoảng cách giữa các bậc

        // Màu sắc đại diện cho các Nucleotide (A-T, G-C)
        const colors = [0xff4d4d, 0x4dff4d, 0x4d4dff, 0xffff4d]; // Đỏ, Xanh lá, Xanh dương, Vàng

        for (let i = 0; i < numPoints; i++) {
            const angle = i * 0.5;
            const y = i * heightStep - (numPoints * heightStep) / 2;

            // Vị trí 2 mạch xoắn
            const x1 = Math.cos(angle) * curveRadius;
            const z1 = Math.sin(angle) * curveRadius;
            const x2 = Math.cos(angle + Math.PI) * curveRadius;
            const z2 = Math.sin(angle + Math.PI) * curveRadius;

            // Tạo các hạt trên mạch chính (Sugar-Phosphate backbone)
            const sphereGeom = new THREE.SphereGeometry(0.3, 16, 16);
            const sphereMat = new THREE.MeshPhongMaterial({ color: 0xffffff });
            
            const s1 = new THREE.Mesh(sphereGeom, sphereMat);
            s1.position.set(x1, y, z1);
            const s2 = new THREE.Mesh(sphereGeom, sphereMat);
            s2.position.set(x2, y, z2);
            dnaGroup.add(s1, s2);

            // Tạo thanh liên kết (Cặp Bazơ)
            const stickGeom = new THREE.CylinderGeometry(0.1, 0.1, curveRadius * 2);
            const stickMat = new THREE.MeshPhongMaterial({ 
                color: colors[i % colors.length], // Đổi màu luân phiên
                emissive: colors[i % colors.length],
                emissiveIntensity: 0.2
            });
            const stick = new THREE.Mesh(stickGeom, stickMat);
            
            stick.position.set(0, y, 0);
            stick.rotation.z = Math.PI / 2;
            stick.rotation.y = -angle;
            dnaGroup.add(stick);
        }

        scene.add(dnaGroup);

        // 5. Hiệu ứng hoạt hình
        function animate() {
            requestAnimationFrame(animate);
            dnaGroup.rotation.y += 0.01; // ADN tự xoay chậm
            renderer.render(scene, camera);
        }

        // Tự động điều chỉnh khi đổi kích thước màn hình
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>
