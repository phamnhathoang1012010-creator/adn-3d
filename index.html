<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ADN 3D</title>

<style>
html,body {
  margin:0;
  padding:0;
  background:black;
  overflow:hidden;
  touch-action:none;
  font-family:system-ui;
}

/* UI */
#ui {
  position:fixed;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:8px;
  z-index:10;
}
button{
  padding:10px 16px;
  border:none;
  border-radius:10px;
  background:#1e90ff;
  color:white;
  font-weight:600;
}
</style>
</head>

<body>
<div id="ui">
  <button onclick="mode='xoan'">Xoắn</button>
  <button onclick="mode='thao'">Tháo</button>
  <button onclick="mode='nhan'">Nhân đôi</button>
</div>

<!-- THREE -->
<script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.152.2/examples/js/controls/OrbitControls.js"></script>

<script>
/* ===== FIX LỖI ĐEN ===== */
const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(
  60,
  window.innerWidth/window.innerHeight,
  0.1,
  1000
);
camera.position.set(0,0,35);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth,window.innerHeight);
renderer.setPixelRatio(window.devicePixelRatio);
document.body.appendChild(renderer.domElement);

/* ánh sáng (rất quan trọng – thiếu là đen) */
scene.add(new THREE.AmbientLight(0xffffff,0.6));
const light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(10,10,10);
scene.add(light);

/* điều khiển chạm tay */
const controls = new THREE.OrbitControls(camera,renderer.domElement);
controls.enableDamping = true;

/* ===== ADN 3D ===== */
const dna = new THREE.Group();
scene.add(dna);

const colors = {
  A:0xff4d4d,
  T:0x4da6ff,
  G:0x4dff4d,
  C:0xffd24d
};

for(let i=0;i<60;i++){
  const angle = i*0.35;
  const y = (i-30)*0.6;

  const geo = new THREE.SphereGeometry(0.45,16,16);

  const b1 = new THREE.Mesh(
    geo,
    new THREE.MeshStandardMaterial({color:Object.values(colors)[i%4]})
  );
  b1.position.set(Math.cos(angle)*4,y,Math.sin(angle)*4);

  const b2 = new THREE.Mesh(
    geo,
    new THREE.MeshStandardMaterial({color:Object.values(colors)[(i+2)%4]})
  );
  b2.position.set(-Math.cos(angle)*4,y,-Math.sin(angle)*4);

  dna.add(b1,b2);

  const bond = new THREE.Mesh(
    new THREE.CylinderGeometry(0.08,0.08,8),
    new THREE.MeshStandardMaterial({color:0xcccccc})
  );
  bond.rotation.z = Math.PI/2;
  bond.position.y = y;
  dna.add(bond);
}

/* ===== CHẾ ĐỘ ===== */
let mode = 'xoan';

/* ===== ANIMATE ===== */
function animate(){
  requestAnimationFrame(animate);

  if(mode==='xoan') dna.rotation.y += 0.01;
  if(mode==='thao') dna.rotation.y += 0.002;
  if(mode==='nhan') dna.scale.setScalar(1+Math.sin(Date.now()*0.002)*0.05);

  controls.update();
  renderer.render(scene,camera);
}
animate();

/* resize */
window.addEventListener('resize',()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>
</body>
</html>
