<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Mô phỏng ADN 3D</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { margin: 0; background: black; overflow: hidden; }
    h1 {
      position: absolute;
      top: 20px;
      width: 100%;
      text-align: center;
      color: white;
      font-family: serif;
      font-size: 36px;
      z-index: 10;
    }
  </style>
</head>
<body>
  <h1>Mô phỏng ADN 3D</h1>

  <!-- THREE -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/controls/OrbitControls.js"></script>

  <script>
    // SCENE
    const scene = new THREE.Scene();

    // CAMERA
    const camera = new THREE.PerspectiveCamera(
      60,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );
    camera.position.set(0, 0, 25);

    // RENDERER
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // CONTROLS
    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.enableZoom = true;

    // LIGHT
    scene.add(new THREE.AmbientLight(0xffffff, 0.8));
    const light = new THREE.DirectionalLight(0xffffff, 0.8);
    light.position.set(10, 20, 10);
    scene.add(light);

    // ADN GROUP
    const dna = new THREE.Group();
    scene.add(dna);

    // BASE DATA
    const baseTypes = ["A", "T", "G", "C"];
    const colors = {
      A: 0xff4d4d, // đỏ
      T: 0x4da6ff, // xanh dương
      G: 0x4dff88, // xanh lá
      C: 0xffdd4d  // vàng
    };

    const sphereGeo = new THREE.SphereGeometry(0.4, 32, 32);

    for (let i = 0; i < 12; i++) {
      const angle = i * 0.6;
      const y = i * 1.2 - 7;

      const leftType = baseTypes[i % 4];
      const rightType = { A:"T", T:"A", G:"C", C:"G" }[leftType];

      const leftPos = new THREE.Vector3(
        Math.cos(angle) * 4,
        y,
        Math.sin(angle) * 4
      );

      const rightPos = new THREE.Vector3(
        Math.cos(angle + Math.PI) * 4,
        y,
        Math.sin(angle + Math.PI) * 4
      );

      const left = new THREE.Mesh(
        sphereGeo,
        new THREE.MeshStandardMaterial({ color: colors[leftType] })
      );
      left.position.copy(leftPos);

      const right = new THREE.Mesh(
        sphereGeo,
        new THREE.MeshStandardMaterial({ color: colors[rightType] })
      );
      right.position.copy(rightPos);

      // LIÊN KẾT HYDRO
      const distance = leftPos.distanceTo(rightPos);
      const bondGeo = new THREE.CylinderGeometry(0.07, 0.07, distance, 16);
      const bond = new THREE.Mesh(
        bondGeo,
        new THREE.MeshStandardMaterial({ color: 0xffffff })
      );

      bond.position.copy(
        leftPos.clone().add(rightPos).multiplyScalar(0.5)
      );

      bond.quaternion.setFromUnitVectors(
        new THREE.Vector3(0, 1, 0),
        rightPos.clone().sub(leftPos).normalize()
      );

      dna.add(left, right, bond);
    }

    // ANIMATE
    function animate() {
      requestAnimationFrame(animate);
      dna.rotation.y += 0.003;
      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    // RESIZE
    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
