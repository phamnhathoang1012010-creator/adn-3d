<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Mô phỏng tái bản ADN – Cách 2</title>
<style>
body{margin:0;overflow:hidden;background:black}
.label{
  position:fixed;color:white;font-size:14px;
}
#l1{top:10px;left:10px}
#l2{top:30px;left:10px}
</style>
</head>
<body>

<div class="label" id="l1">Nhánh 1: quay – bị tháo xoắn</div>
<div class="label" id="l2">Nhánh 2: đứng yên (khuôn)</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152/build/three.min.js"></script>
<script>
const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,1000);
camera.position.z=45;

const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,0.6));
const light=new THREE.PointLight(0xffffff,1);
light.position.set(20,20,20);
scene.add(light);

/* ====== TẠO NUCLEOTIDE ====== */
function base(color){
  return new THREE.Mesh(
    new THREE.BoxGeometry(1.2,1.8,0.8),
    new THREE.MeshStandardMaterial({color})
  );
}

/* ====== NHÁNH 1 (QUAY) ====== */
const strand1=new THREE.Group();
for(let i=0;i<16;i++){
  const b=base(i%2?0xffc107:0x03a9f4);
  b.position.set(-6, i*2-15, Math.sin(i)*2);
  strand1.add(b);
}
scene.add(strand1);

/* ====== NHÁNH 2 (ĐỨNG YÊN) ====== */
const strand2=new THREE.Group();
for(let i=0;i<16;i++){
  const b=base(i%2?0x9c27b0:0x4caf50);
  b.position.set(6, i*2-15, 0);
  strand2.add(b);
}
scene.add(strand2);

/* ====== HELICASE (ENZYME THÁO XOẮN) ====== */
const helicase=new THREE.Mesh(
  new THREE.TorusGeometry(3,0.6,16,100),
  new THREE.MeshStandardMaterial({color:0x8bc34a})
);
helicase.rotation.x=Math.PI/2;
scene.add(helicase);

let hDir=1;

/* ====== MŨI TÊN 3' → 5' ====== */
function arrow(x,y,dir){
  const a=new THREE.ArrowHelper(
    new THREE.Vector3(0,dir,0),
    new THREE.Vector3(x,y,0),
    4,0xffffff
  );
  scene.add(a);
}
arrow(-6,-18,1); // nhánh 1
arrow(6,18,-1); // nhánh 2

/* ====== ANIMATE ====== */
function animate(){
  requestAnimationFrame(animate);

  // Nhánh 1 quay (tháo xoắn)
  strand1.rotation.y+=0.01;

  // Nhánh 2 đứng yên → KHÔNG XOAY

  // Enzyme tháo xoắn di chuyển lên xuống
  helicase.position.y+=0.08*hDir;
  if(helicase.position.y>10||helicase.position.y<-10) hDir*=-1;

  // Enzyme ôm 2 nucleotide
  helicase.position.x=0;

  renderer.render(scene,camera);
}
animate();

window.onresize=()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
};
</script>
</body>
</html>
