<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>M√¥ ph·ªèng ADN 3D</title>
<style>
body { margin:0; background:black; overflow:hidden; color:white; font-family:Arial }
#ui {
  position:fixed; top:10px; right:10px;
}
button {
  padding:6px 10px; margin:3px;
  border-radius:6px; border:none; cursor:pointer;
}
button.active { background:#2ecc71 }
#legend {
  position:fixed; top:10px; left:10px; font-size:14px;
}
</style>
</head>
<body>

<div id="legend">
üü° A &nbsp; üîµ T &nbsp; üü• G &nbsp; üü¢ C<br>
Nh√°nh 1: th√°o xo·∫Øn ‚Äì quay<br>
Nh√°nh 2: m·∫°ch khu√¥n (3‚Äô‚Üí5‚Äô)
</div>

<div id="ui">
<button id="b1" class="active">Nh√°nh 1</button>
<button id="b2" class="active">Nh√°nh 2</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<script>
// ===== SCENE =====
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x000000);

const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
camera.position.z = 30;

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

window.onresize = ()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
};

// ===== LIGHT =====
scene.add(new THREE.AmbientLight(0xffffff,0.7));
const dl = new THREE.DirectionalLight(0xffffff,1);
dl.position.set(5,10,10);
scene.add(dl);

// ===== COLORS =====
const baseColors = {
  A:0xf1c40f, T:0x3498db, G:0xe74c3c, C:0x2ecc71
};

// ===== NH√ÅNH 1 (XOAY) =====
const branch1 = new THREE.Group();
scene.add(branch1);

for(let i=0;i<16;i++){
  const base = new THREE.Mesh(
    new THREE.BoxGeometry(0.8,0.8,0.8),
    new THREE.MeshStandardMaterial({color: i%2?baseColors.T:baseColors.A})
  );
  base.position.set(Math.sin(i*0.6)*3, i-8, Math.cos(i*0.6));
  branch1.add(base);
}

// ===== NH√ÅNH 2 (ƒê·ª®NG Y√äN) =====
const branch2 = new THREE.Group();
scene.add(branch2);

for(let i=0;i<20;i++){
  const base = new THREE.Mesh(
    new THREE.BoxGeometry(0.8,0.8,0.8),
    new THREE.MeshStandardMaterial({color: i%2?baseColors.C:baseColors.G})
  );
  base.position.set(6, i-10, 0);
  branch2.add(base);
}

// ===== HELICASE =====
const helicase = new THREE.Group();
const core = new THREE.Mesh(
  new THREE.CylinderGeometry(1.2,1.2,1,32),
  new THREE.MeshStandardMaterial({color:0x7bed9f})
);
helicase.add(core);

const n1 = new THREE.Mesh(
  new THREE.BoxGeometry(0.6,0.6,0.6),
  new THREE.MeshStandardMaterial({color:0xff9800})
);
n1.position.x = -1;
const n2 = n1.clone();
n2.position.x = 1;
helicase.add(n1,n2);

scene.add(helicase);

// ===== OKAZAKI =====
const okazaki = new THREE.Group();
scene.add(okazaki);

for(let i=0;i<6;i++){
  const f = new THREE.Mesh(
    new THREE.BoxGeometry(0.7,0.7,0.7),
    new THREE.MeshStandardMaterial({color:0xff5722})
  );
  f.position.set(4,-10-i*1.2,0);
  okazaki.add(f);
}

// ===== UI =====
let show1 = true, show2 = true;
b1.onclick=()=>{show1=!show1;branch1.visible=show1;b1.classList.toggle("active");};
b2.onclick=()=>{show2=!show2;branch2.visible=show2;b2.classList.toggle("active");};

// ===== ANIMATION =====
let hDir = 0.05;
function animate(){
  requestAnimationFrame(animate);

  // Nh√°nh 1 quay
  if(show1) branch1.rotation.y += 0.01;

  // Helicase di chuy·ªÉn
  helicase.position.y += hDir;
  if(helicase.position.y>8 || helicase.position.y<-8) hDir*=-1;

  // Okazaki theo sau helicase
  okazaki.children.forEach(o=>{
    if(o.position.y < helicase.position.y){
      o.position.y += 0.02;
    }
  });

  renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>
