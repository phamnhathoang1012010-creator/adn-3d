<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ADN – Okazaki fragments</title>
<style>
body{margin:0;overflow:hidden;background:black}
.txt{position:fixed;color:white;font-size:14px;left:10px}
</style>
</head>
<body>

<div class="txt" style="top:10px">Nhánh 1: bị tháo xoắn – quay</div>
<div class="txt" style="top:30px">Nhánh 2: mạch khuôn (đứng yên)</div>
<div class="txt" style="top:50px">Mạch sau: ĐOẠN OKAZAKI</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152/build/three.min.js"></script>
<script>
const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,1000);
camera.position.z=50;

const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,0.6));
const light=new THREE.PointLight(0xffffff,1);
light.position.set(20,20,20);
scene.add(light);

/* ==== BASE ==== */
function base(color){
 return new THREE.Mesh(
  new THREE.BoxGeometry(1.2,1.8,0.8),
  new THREE.MeshStandardMaterial({color})
 );
}

/* ==== NHÁNH 1 (XOAY) ==== */
const strand1=new THREE.Group();
for(let i=0;i<18;i++){
 const b=base(0xffc107);
 b.position.set(-8,i*2-18,Math.sin(i)*2);
 strand1.add(b);
}
scene.add(strand1);

/* ==== NHÁNH 2 (KHUÔN) ==== */
const strand2=new THREE.Group();
for(let i=0;i<18;i++){
 const b=base(0x03a9f4);
 b.position.set(8,i*2-18,0);
 strand2.add(b);
}
scene.add(strand2);

/* ==== HELICASE ==== */
const helicase=new THREE.Mesh(
 new THREE.TorusGeometry(3,0.6,16,100),
 new THREE.MeshStandardMaterial({color:0x8bc34a})
);
helicase.rotation.x=Math.PI/2;
scene.add(helicase);

/* ==== DNA POLYMERASE ==== */
function polymerase(x){
 return new THREE.Mesh(
  new THREE.CylinderGeometry(1.6,1.6,1.2,32),
  new THREE.MeshStandardMaterial({color:0x00e5ff})
 );
}
const polLead=polymerase(-6); // mạch dẫn
const polLag=polymerase(6);  // mạch sau
scene.add(polLead,polLag);

/* ==== OKAZAKI FRAGMENTS ==== */
const okazaki=new THREE.Group();
for(let i=0;i<5;i++){
 const f=base(0xff5722);
 f.position.set(6, i*3-6, 0);
 okazaki.add(f);
}
scene.add(okazaki);

/* ==== ARROWS ==== */
function arrow(x,y,dir){
 const a=new THREE.ArrowHelper(
  new THREE.Vector3(0,dir,0),
  new THREE.Vector3(x,y,0),
  4,0xffffff
 );
 scene.add(a);
}
arrow(-8,-22,1); // 3'→5'
arrow(8,22,-1);  // 5'→3'

let hDir=1;

function animate(){
 requestAnimationFrame(animate);

 strand1.rotation.y+=0.01;

 helicase.position.y+=0.1*hDir;
 if(helicase.position.y>12||helicase.position.y<-12) hDir*=-1;

 polLead.position.y=helicase.position.y-2;
 polLag.position.y=helicase.position.y+2;

 // Okazaki fragments xuất hiện gián đoạn
 okazaki.children.forEach((f,i)=>{
  f.visible=Math.sin(Date.now()*0.002+i)>0;
 });

 renderer.render(scene,camera);
}
animate();

window.onresize=()=>{
 camera.aspect=innerWidth/innerHeight;
 camera.updateProjectionMatrix();
 renderer.setSize(innerWidth,innerHeight);
};
</script>
</body>
</html>
