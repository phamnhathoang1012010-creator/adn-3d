<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>M√¥ ph·ªèng ADN 3D</title>
<style>
body{margin:0;background:black;color:white;font-family:Arial;text-align:center}
button{margin:6px;padding:10px 16px;border-radius:20px;border:none;background:#222;color:white}
button.active{background:#0aa}
input{width:300px}
canvas{display:block}
</style>
</head>
<body>

<h3>üß¨ M√î PH·ªéNG ADN 3D</h3>

<div>
  <button onclick="setMode(1,this)">ADN xo·∫Øn 3D</button>
  <button onclick="setMode(2,this)">Th√°o xo·∫Øn</button>
  <button onclick="setMode(3,this)">Nh√¢n ƒë√¥i rDNA</button>
</div>

<input type="range" min="0" max="100" value="0" id="slider">

<script src="https://unpkg.com/three@0.158.0/build/three.min.js"></script>
<script>
let scene,camera,renderer,mode=1;
const slider=document.getElementById("slider");
let dna=[],links=[],enzyme,polymerase;

init();
animate();

function setMode(m,btn){
  mode=m;
  slider.value=0;
  scene.clear();
  dna=[];links=[];
  if(m===1)createHelix();
  if(m===2)createUnzip();
  if(m===3)createReplication();
  document.querySelectorAll("button").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
}

function init(){
  scene=new THREE.Scene();
  camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,1000);
  camera.position.z=50;

  renderer=new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(innerWidth,innerHeight);
  document.body.appendChild(renderer.domElement);

  const light=new THREE.PointLight(0xffffff,1);
  light.position.set(50,50,50);
  scene.add(light);

  createHelix();
}

function sphere(color){
  return new THREE.Mesh(
    new THREE.SphereGeometry(0.8,16,16),
    new THREE.MeshStandardMaterial({color})
  );
}

function createHelix(){
  for(let i=0;i<20;i++){
    let a=i*0.5;
    let s1=sphere(0xff4444);
    let s2=sphere(0x44ff44);
    s1.position.set(Math.cos(a)*5,i-10,Math.sin(a)*5);
    s2.position.set(Math.cos(a+Math.PI)*5,i-10,Math.sin(a+Math.PI)*5);
    scene.add(s1,s2);
    dna.push(s1,s2);
  }
}

function createUnzip(){
  for(let i=0;i<20;i++){
    let s1=sphere(0x4488ff);
    let s2=sphere(0xffcc33);
    s1.position.set(-4,i-10,0);
    s2.position.set(4,i-10,0);
    scene.add(s1,s2);
    dna.push({s1,s2});
  }
  enzyme=new THREE.Mesh(
    new THREE.BoxGeometry(10,1,2),
    new THREE.MeshStandardMaterial({color:0xff8800})
  );
  scene.add(enzyme);
}

function createReplication(){
  for(let i=0;i<20;i++){
    let s=sphere(0xff4444);
    s.position.set(-4,i-10,0);
    scene.add(s);
    dna.push(s);
  }
  polymerase=new THREE.Mesh(
    new THREE.BoxGeometry(3,1,2),
    new THREE.MeshStandardMaterial({color:0x00ffff})
  );
  scene.add(polymerase);
}

function animate(){
  requestAnimationFrame(animate);
  const t=slider.value/100;

  if(mode===1){
    scene.rotation.y=t*Math.PI*2;
    scene.scale.set(0.6+t,0.6+t,0.6+t);
  }

  if(mode===2){
    let cut=Math.floor(t*20);
    dna.forEach((p,i)=>{
      p.s1.position.x=i<cut?-8:-4;
      p.s2.position.x=i<cut?8:4;
    });
    enzyme.position.y=cut-10;
  }

  if(mode===3){
    let build=Math.floor(t*20);
    polymerase.position.y=build-10;
    dna.forEach((s,i)=>{
      if(i<build){
        let c=sphere(0x44ff44);
        c.position.set(4,i-10,0);
        scene.add(c);
      }
    });
  }

  renderer.render(scene,camera);
}
</script>
</body>
</html>
