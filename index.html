<script>
/* ===== SCENE ===== */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x000000);

/* CAMERA – NHÌN THẲNG SGK */
const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 100);
camera.position.set(0, 0, 20);
camera.lookAt(0, 0, 0);

/* RENDER */
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

/* KHÓA XOAY – CHỈ ZOOM */
const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableRotate = false;
controls.enablePan = false;
controls.enableZoom = true;

/* RESIZE */
window.onresize = () => {
  camera.aspect = innerWidth / innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
};

/* LIGHT */
scene.add(new THREE.AmbientLight(0xffffff, 1));

/* ===== ADN ===== */
const branch1 = new THREE.Group(); // mạch tháo xoắn
const branch2 = new THREE.Group(); // mạch khuôn
scene.add(branch1, branch2);

for (let i = 0; i < 16; i++) {
  const y = i - 8;

  const b1 = new THREE.Mesh(
    new THREE.BoxGeometry(0.7, 0.7, 0.7),
    new THREE.MeshStandardMaterial({ color: 0xf1c40f })
  );
  b1.position.set(-2, y, 0);
  branch1.add(b1);

  const b2 = new THREE.Mesh(
    new THREE.BoxGeometry(0.7, 0.7, 0.7),
    new THREE.MeshStandardMaterial({ color: 0x3498db })
  );
  b2.position.set(2, y, 0);
  branch2.add(b2);
}

/* ===== HELICASE ===== */
const helicase = new THREE.Mesh(
  new THREE.CylinderGeometry(1, 1, 0.8, 32),
  new THREE.MeshStandardMaterial({ color: 0x7bed9f })
);
helicase.rotation.z = Math.PI / 2;
helicase.position.y = -8;
helicase.visible = false;
scene.add(helicase);

/* ===== OKAZAKI ===== */
const okazaki = new THREE.Group();
for (let i = 0; i < 4; i++) {
  const f = new THREE.Mesh(
    new THREE.BoxGeometry(0.6, 0.6, 0.6),
    new THREE.MeshStandardMaterial({ color: 0xff5722 })
  );
  f.position.set(3.5, -8 - i * 1.2, 0);
  okazaki.add(f);
}
okazaki.visible = false;
scene.add(okazaki);

/* ===== STEP ===== */
let step = 1;
s1.onclick = () => step = 1;
s2.onclick = () => step = 2;
s3.onclick = () => step = 3;

/* ===== ANIMATION ===== */
function animate() {
  requestAnimationFrame(animate);

  if (step >= 2) {
    helicase.visible = true;
    helicase.position.y += 0.03;
    if (helicase.position.y > 8) helicase.position.y = -8;
  } else {
    helicase.visible = false;
  }

  if (step >= 3) {
    okazaki.visible = true;
  } else {
    okazaki.visible = false;
  }

  renderer.render(scene, camera);
}
animate();
</script>
